//   ▄▄       ▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄
//  ▐░░▌     ▐░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌
//  ▐░▌░▌   ▐░▐░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌ ▀▀▀▀▀▀▀▀▀█░▌     ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌
//  ▐░▌▐░▌ ▐░▌▐░▌▐░▌       ▐░▌▐░▌       ▐░▌          ▐░▌     ▐░▌          ▐░▌       ▐░▌
//  ▐░▌ ▐░▐░▌ ▐░▌▐░█▄▄▄▄▄▄▄█░▌▐░▌       ▐░▌ ▄▄▄▄▄▄▄▄▄█░▌     ▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄█░▌
//  ▐░▌  ▐░▌  ▐░▌▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌
//  ▐░▌   ▀   ▐░▌▐░█▀▀▀▀▀▀▀█░▌▐░▌       ▐░▌▐░█▀▀▀▀▀▀▀▀▀      ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀█░█▀▀
//  ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌       ▐░▌▐░▌               ▐░▌          ▐░▌     ▐░▌
//  ▐░▌       ▐░▌▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄▄▄      ▐░▌          ▐░▌      ▐░▌
//  ▐░▌       ▐░▌▐░▌       ▐░▌▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌     ▐░▌          ▐░▌       ▐░▌
//   ▀         ▀  ▀         ▀  ▀▀▀▀▀▀▀▀▀▀   ▀▀▀▀▀▀▀▀▀▀▀       ▀            ▀         ▀
//
//   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄
//  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌
//  ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌ ▀▀▀▀▀█░█▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀  ▀▀▀▀█░█▀▀▀▀
//  ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌       ▐░▌      ▐░▌    ▐░▌          ▐░▌               ▐░▌
//  ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌▐░▌       ▐░▌      ▐░▌    ▐░█▄▄▄▄▄▄▄▄▄ ▐░▌               ▐░▌
//  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌       ▐░▌      ▐░▌    ▐░░░░░░░░░░░▌▐░▌               ▐░▌
//  ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀█░█▀▀ ▐░▌       ▐░▌      ▐░▌    ▐░█▀▀▀▀▀▀▀▀▀ ▐░▌               ▐░▌
//  ▐░▌          ▐░▌     ▐░▌  ▐░▌       ▐░▌      ▐░▌    ▐░▌          ▐░▌               ▐░▌
//  ▐░▌          ▐░▌      ▐░▌ ▐░█▄▄▄▄▄▄▄█░▌ ▄▄▄▄▄█░▌    ▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄▄▄      ▐░▌
//  ▐░▌          ▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░▌    ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     ▐░▌
//   ▀            ▀         ▀  ▀▀▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀      ▀▀▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀▀▀▀       ▀
//
//
//
//

#include <iostream> // I:O stream
#include <iomanip> // I:O manipulation
#include "morpion.hpp"
#include "menu.hpp"

int main()
{
    std::string firstPlayer{};
    std::string secondPlayer{};
    while(1)
    {
        char mode {menuTextMain()};

        if(mode == '4')
            return 0;

        switch(mode)
        {
        case '1':
            std::cout << "[Player 1] Enter your name >>> ";
            std::cin >> std::setw(20) >> firstPlayer;

            std::cout << "[Player 2] Enter your name >>> ";
            std::cin >> std::setw(20) >> secondPlayer;

            std::cout << "-" << firstPlayer << " you are the CIRCLE !" << std::endl;
            std::cout << "-" << secondPlayer << " you are the CROSS !" << std::endl;
            break;
        case '2':
            std::cout << "[Player 1] Enter your name >>> ";
            std::cin >> std::setw(20) >> firstPlayer;

            std::cout << "-" << firstPlayer << " you are the CIRCLE !" << std::endl;
            break;
        }

        TicTacToe tictactoe =createNewGame();
        std::string userInput{};

        while(!tictactoe.gameOver)
        {

            printArray(tictactoe.board);

            switch(mode)
            {
            case '1':
                    if(tictactoe.play == Switch::CIRCLE)
                    {
                    bool isOk;
                    do
                    {
                        isOk = true;
                        std::cout << "What is your position ?" << std::endl << " >>> ";
                        std::cin >> std::setw(1) >> userInput;

                        if((userInput.front() < 49) ^ (userInput.front() > 57))
                        {
                            isOk = false;
                            std::cout << "Please enter a number in this list {1, 2, 3, 4, 5, 6, 7, 8, 9}" << std::endl;
                        }
                    }while(!isOk);
                    transformInputToCoordinate(tictactoe, userInput);

                    std::cout << "[" << firstPlayer << "] => "  << "'O' (" << tictactoe.position.x << ";" << tictactoe.position.y << ")" << std::endl;
                    setPosition(tictactoe.board, tictactoe.position.x, tictactoe.position.y, tictactoe.player.at(0));

                    tictactoe.play = Switch::CROSS;
            }
            else
            {
                bool isOk;
                do
                {
                    isOk = true;
                    std::cout << "What is your position ?" << std::endl << " >>> ";
                    std::cin >> std::setw(1) >> userInput;

                    if((userInput.front() < 49) ^ (userInput.front() > 57))
                    {
                        isOk = false;
                        std::cout << "Please enter a number in this list {1, 2, 3, 4, 5, 6, 7, 8, 9}" << std::endl;
                    }
                }while(!isOk);
                transformInputToCoordinate(tictactoe, userInput);

                std::cout << "[" << secondPlayer << "] => " << "'X' (" << tictactoe.position.x << ";" << tictactoe.position.y << ")" << std::endl;
                setPosition(tictactoe.board, tictactoe.position.x, tictactoe.position.y, tictactoe.player.at(1));

                tictactoe.play = Switch::CIRCLE;
            }
            check(tictactoe);
                break;
            case '2':
                if(tictactoe.play == Switch::CIRCLE)
                    {
                    bool isOk;
                    do
                    {
                        isOk = true;
                        std::cout << "What is your position ?" << std::endl << " >>> ";
                        std::cin >> std::setw(1) >> userInput;

                        if((userInput.front() < 49) ^ (userInput.front() > 57))
                        {
                            isOk = false;
                            std::cout << "Please enter a number in this list {1, 2, 3, 4, 5, 6, 7, 8, 9}" << std::endl;
                        }
                    }while(!isOk);
                    transformInputToCoordinate(tictactoe, userInput);

                    std::cout << "[" << firstPlayer << "] => "  << "'O' (" << tictactoe.position.x << ";" << tictactoe.position.y << ")" << std::endl;
                    setPosition(tictactoe.board, tictactoe.position.x, tictactoe.position.y, tictactoe.player.at(0));

                    tictactoe.play = Switch::CROSS;
            }
            else
            {
                    // IA minimax
                int ia {iaComputer(tictactoe)};

                transformInputToCoordinate(tictactoe, ia);

                std::cout << "[COMPUTER] => " << "'X' (" << tictactoe.position.x << ";" << tictactoe.position.y << ")" << std::endl;
                setPosition(tictactoe.board, tictactoe.position.x, tictactoe.position.y, tictactoe.player.at(1));

                tictactoe.play = Switch::CIRCLE;
            }
            check(tictactoe);

                break;
            }
            std::cout << std::endl;
            std::cout << "===========================" << std::endl;
            std::cout << "-       BOARD RESULT      -" << std::endl;
            std::cout << "===========================" << std::endl;

            printArray(tictactoe.board);

         }
    }
    return 0;
}
